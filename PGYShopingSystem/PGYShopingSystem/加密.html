<html>
<script type="text/javaScript">
    String.prototype.format = function () {
        var result = this;
        if (arguments.length == 0)
            return null;
        for (var i = 0; i < arguments.length; i++) {
            var re = new RegExp('\\{' + (i) + '\\}', 'gm');
            result = result.replace(re, arguments[i]);
        }
        return result;
    }
</script>
<body>
</body>
<script type="text/javaScript">
    var key = 'PGY';
    var str = "{'tAblename':'xs_zdjbxx','wheret':''}";
    var str = "{\"Type\":\"1\",\"Data\":\"{'tablename':'xs_zdjbxx t','fields':'zl,ysdm','WhereT':'t.zddm=^610821104200GB00039^','Orderby':'t.bsm'}\"}";

    var obj1 = sed("1", "xs_zdjbxx t", "t.zl,t.ysdm", "t.zddm=^610802003004JB00001^", "t.bsm", true);
    var obj = sed("1", "xs_zdjbxx t", "t.zl,t.ysdm", "t.zddm=^610802003004JB00001^", "t.bsm");
    var obji = ind("2", "xs_zdjbxx", "bdcdyh,ysdm", "653122112,6666", true);
    var obji1 = ind("2", "xs_zdjbxx", "bdcdyh,ysdm", "653122112,6666");
    var obju = upd("3", "xs_zdjbxx", "bdcdyh,ysdm", "653122112,6666","bsm=^6666^", true);
    var obju1 = upd("3", "xs_zdjbxx", "bdcdyh,ysdm", "653122112,6666", "bsm=^6666^");
    var objd = ded("4", "xs_zdjbxx", "bsm=^6666^", true);
    var objd1 = ded("4", "xs_zdjbxx", "bsm=^6666^");
    var stepk1 = obj1.Data.length % (key.length % 5);
    var stepk = obj.Data.length % (key.length % 5);
    var co = code(obj.Data);
    var eco = code(co,true);
    var cow = code(obj1.Data);
    document.write('key：' + key + ' step：' + stepk + ' len:' + obj.Data.length + '<br/>');
    document.write('format：' + JSON.stringify(obj1) + '  len:' + obj1.Data.length + '<br/>');
    document.write('forjam：' + JSON.stringify(obj) + '  len:' + obj.Data.length + '<br/>');
    document.write('format：' + JSON.stringify(obji1) + '  len:' + obji1.Data.length + '<br/>');
    document.write('forjam：' + JSON.stringify(obji) + '  len:' + obji.Data.length + '<br/>');
    document.write('format：' + JSON.stringify(obju1) + '  len:' + obju1.Data.length + '<br/>');
    document.write('forjam：' + JSON.stringify(obju) + '  len:' + obju.Data.length + '<br/>');
    document.write('format：' + JSON.stringify(objd1) + '  len:' + objd1.Data.length + '<br/>');
    document.write('forjam：' + JSON.stringify(objd) + '  len:' + objd.Data.length + '<br/>');
    document.write('ceshiz：{"Type":"1","Data":"' + "Ë'Äa²lµn±mµ''Ès¯z´j²xÈ Ä'|'¶iµl´sw:wz¼,És´mw,wW¸eÂe¤''Ä.Êd´m^181020B03^w,woÂdµr²yw:wt~bÃmw}" + '<br/>');
    var objj = obj;
    objj.Data = jiami(objj.Data, key, true, stepk);
    document.write('jiemaf：' + JSON.stringify(objj) + '  len:' + objj.Data.length + '<br/>');
    document.write('解密编码：' + co + '<br/>' + '反密字符：' + eco + '<br/>' + '未加密码：' + cow + '<br/>');
    //"{0}-{1}-{2}".format("xx","yy","zz")
    //显示xx-yy-zz

    //{"Type":"1","Data":"{'tablename':'xs_zdjbxx t','fields':'zl,ysdm','WhereT':'t.zddm=^610821104200GB00039^'}"}
    ///-------Act
    function sed(typ, tbn, fid, whe, ord, isnoenc) {
        var istr = { Type: typ, Data: "" };
        isnoenc = !isnoenc ? true : false;
        if (typ.length > 0 && tbn.length > 0 && fid.length > 0) {
            istr = { Type: typ, Data: "{'TableName':'{0}','Fields':'{1}','WhereT':'{2}','OrderBy':'{3}'}".format(tbn, fid, whe, ord) };
        }
        if (isnoenc) {
            if (istr.Data.length > 0) {
                var stepk = istr.Data.length % (key.length % 5);
                istr.Data = jiami(istr.Data, key, false, stepk);
            }
        }
        return istr;
    }
    function ind(typ, tbn, fid, val, isnoenc) {
        var istr = { Type: typ, Data: "" };
        isnoenc = !isnoenc ? true : false;
        if (typ.length > 0 && tbn.length > 0 && fid.length > 0, val.length > 0) {
            istr = { Type: typ, Data: "{'TableName':'{0}','Fields':'{1}','Values':'{2}'}".format(tbn, fid, val) };
        }
        if (isnoenc) {
            if (istr.Data.length > 0) {
                var stepk = istr.Data.length % (key.length % 5);
                istr.Data = jiami(istr.Data, key, false, stepk);
            }
        }
        return istr;
    }
    function upd(typ, tbn, fid, val, whe, isnoenc) {
        var istr = { Type: typ, Data: "" };
        isnoenc = !isnoenc ? true : false;
        if (typ.length > 0 && tbn.length > 0 && fid.length > 0) {
            istr = { Type: typ, Data: "{'TableName':'{0}','Fields':'{1}','Vlaues':'{2}','WhereT':'{3}'}".format(tbn, fid, val, whe) };
        }
        if (isnoenc) {
            if (istr.Data.length > 0) {
                var stepk = istr.Data.length % (key.length % 5);
                istr.Data = jiami(istr.Data, key, false, stepk);
            }
        }
        return istr;
    }
    function ded(typ, tbn, whe, isnoenc) {
        var istr = { Type: typ, Data: "" };
        isnoenc = !isnoenc ? true : false;
        if (typ.length > 0 && tbn.length > 0) {
            istr = { Type: typ, Data: "{'TableName':'{0}','WhereT':'{1}'}".format(tbn, whe) };
        }
        if (isnoenc) {
            if (istr.Data.length > 0) {
                var stepk = istr.Data.length % (key.length % 5);
                istr.Data = jiami(istr.Data, key, false, stepk);
            }
        }
        return istr;
    }
    ///-------End
    function jiami(str, key, isundo, step) {
        var data = "";
        step = !step ? 1 : step;
        if (str.length > 0 && key.length > 0) {
            for (a = 0; a < str.length; a++) {
                var code = str.charCodeAt(a);
                var Y = a % key.length;
                var keycode = key.charCodeAt(Y);
                var tempCode = isundo ? code - keycode : code + keycode;
                //var tempCode=isundo? code-1:code+1;
                if (tempCode >= 65536) { tempCode = code; }
                data += a % step == 0 ? String.fromCharCode(tempCode) : str[a];
            }
        }
        return data;
    }
    function code(str, isecode) {
        var data = "";
        if (!!isecode) {
            if (str.length > 0) {
                var arr = str.split(',');
                for (a = 0; a < str.length; a++) {
                    data += String.fromCharCode(arr[a]);
                }
            }
        } else {
            if (str.length > 0) {
                for (a = 0; a < str.length; a++) {
                    var code = str.charCodeAt(a);
                    data += code + ',';
                }
            }
        }
        return data;
    }
</script>
</html>